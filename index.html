<!DOCTYPE html>
<html lang="pl" data-theme="light" style=""><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formularz Analizy Potrzeb Klienta - Ubezpieczenia na ≈ªycie</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&amp;display=swap" rel="stylesheet">
    <style>
      body {
        max-width: 880px;
        margin: 0 auto;
        padding: 40px;
        font-family: 'Roboto', Arial, sans-serif;
        background-color: #ffffff;
        color: #333333;
        line-height: 1.5;
      }

      h1 {
        font-size: 24px;
        font-weight: 700;
        color: #2c3e50;
        border-bottom: 2px solid #2c3e50;
        padding-bottom: 10px;
        margin-bottom: 30px;
        text-transform: uppercase;
        text-align: center;
      }

      h2 {
        font-size: 18px;
        font-weight: 700;
        color: #2980b9;
        margin-top: 30px;
        margin-bottom: 15px;
        border-bottom: 1px solid #eee;
        padding-bottom: 5px;
      }

      h3 {
        font-size: 16px;
        font-weight: 600;
        color: #444;
        margin-top: 20px;
        margin-bottom: 10px;
      }

      .section {
        margin-bottom: 30px;
      }

      label {
        font-weight: 500;
        font-size: 14px;
        color: #555;
        display: block;
        margin-bottom: 5px;
      }

      input[type='text'],
      input[type='number'],
      input[type='email'],
      input[type='tel'],
      input[type='date'],
      select,
      textarea {
        width: 100%;
        padding: 8px 10px;
        margin-bottom: 15px;
        border: 1px solid #ccc;
        border-radius: 4px;
        font-size: 14px;
        box-sizing: border-box;
        background-color: #f9f9f9;
      }

      textarea {
        resize: vertical;
        min-height: 80px;
      }

      .row {
        display: flex;
        flex-wrap: wrap;
        margin: 0 -10px;
      }

      .col {
        flex: 1;
        padding: 0 10px;
        min-width: 250px;
      }

      .checkbox-group,
      .radio-group {
        margin-bottom: 15px;
      }

      .checkbox-item,
      .radio-item {
        display: flex;
        align-items: center;
        margin-bottom: 8px;
      }

      .checkbox-item input,
      .radio-item input {
        margin-right: 10px;
        width: auto;
        margin-bottom: 0;
      }

      .checkbox-item label,
      .radio-item label {
        margin-bottom: 0;
        font-weight: 400;
        cursor: pointer;
      }

      .signature-section {
        margin-top: 50px;
        padding-top: 20px;
        border-top: 2px solid #eee;
      }

      .signature-box {
        border-top: 1px solid #333;
        width: 80%;
        margin-top: 40px;
        padding-top: 5px;
        font-size: 13px;
        text-align: center;
      }

      .legal-note {
        font-size: 11px;
        color: #777;
        margin-top: 30px;
        text-align: justify;
        line-height: 1.3;
      }

      .header-info {
        display: flex;
        justify-content: space-between;
        margin-bottom: 20px;
        font-size: 12px;
        color: #666;
      }

      .partner-section-content {
        display: none;
        opacity: 0;
        transition: opacity 0.3s ease-in-out;
      }

      .partner-section-content.active {
        display: block;
        opacity: 1;
      }

      .action-buttons {
        display: flex;
        gap: 15px;
        margin: 30px 0;
        flex-wrap: wrap;
        justify-content: center;
      }

      .btn {
        padding: 12px 24px;
        border: none;
        border-radius: 5px;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        text-decoration: none;
        display: inline-block;
      }

      .btn-primary {
        background-color: #2980b9;
        color: white;
      }

      .btn-primary:hover {
        background-color: #1f6391;
      }

      .btn-secondary {
        background-color: #27ae60;
        color: white;
      }

      .btn-secondary:hover {
        background-color: #1e8449;
      }

      .btn-tertiary {
        background-color: #e74c3c;
        color: white;
      }

      .btn-tertiary:hover {
        background-color: #c0392b;
      }

      .no-print {
        /* Ukryj przyciski przy drukowaniu */
      }

      @media print {
        .no-print {
          display: none !important;
        }
        body {
          padding: 20px;
        }
      }

      .required {
        color: #e74c3c;
        font-weight: bold;
      }

      input:invalid, select:invalid, textarea:invalid {
        border-color: #e74c3c;
      }

      .email-modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0,0,0,0.4);
      }

      .email-modal-content {
        background-color: #fefefe;
        margin: 10% auto;
        padding: 30px;
        border: 1px solid #888;
        border-radius: 8px;
        width: 90%;
        max-width: 500px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      }

      .email-modal-close {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
        cursor: pointer;
      }

      .email-modal-close:hover {
        color: #000;
      }

      .priority-item {
        background-color: white;
        padding: 15px;
        margin-bottom: 10px;
        border-radius: 5px;
        border: 2px solid #e0e0e0;
        cursor: move;
        display: flex;
        align-items: center;
        transition: all 0.3s ease;
        position: relative;
      }

      .priority-item:hover {
        border-color: #2980b9;
        box-shadow: 0 2px 8px rgba(41, 128, 185, 0.2);
      }

      .priority-item.dragging {
        opacity: 0.5;
        border-color: #2980b9;
        background-color: #e8f4f8;
      }

      .priority-item.drag-over {
        border-top: 3px solid #2980b9;
      }

      .drag-handle {
        color: #999;
        font-size: 20px;
        margin-right: 15px;
        cursor: grab;
        user-select: none;
      }

      .drag-handle:active {
        cursor: grabbing;
      }

      .priority-number {
        display: inline-block;
        width: 30px;
        font-weight: 700;
        color: #2980b9;
        font-size: 16px;
      }

      .priority-label {
        font-weight: 500;
        font-size: 15px;
        color: #333;
        flex: 1;
      }

      .recommendation-box {
        background-color: white;
        padding: 15px;
        margin-bottom: 15px;
        border-radius: 5px;
        border-left: 4px solid #27ae60;
      }

      .recommendation-box.warning {
        border-left-color: #e74c3c;
      }

      .recommendation-box.info {
        border-left-color: #3498db;
      }

      .recommendation-title {
        font-weight: 700;
        font-size: 16px;
        margin-bottom: 8px;
        color: #2c3e50;
      }

      .recommendation-text {
        font-size: 14px;
        line-height: 1.6;
        color: #555;
      }

      .summary-table {
        width: 100%;
        border-collapse: collapse;
        margin: 15px 0;
        background-color: white;
      }

      .summary-table th,
      .summary-table td {
        padding: 10px;
        text-align: left;
        border: 1px solid #ddd;
      }

      .summary-table th {
        background-color: #2980b9;
        color: white;
        font-weight: 600;
      }

      .summary-table tr:nth-child(even) {
        background-color: #f9f9f9;
      }
    </style>
  </head>
  <body style="">
    <div style="text-align: center; margin-bottom: 30px;">
      <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8IS0tIEJhY2tncm91bmQgLS0+CiAgPHJlY3Qgd2lkdGg9IjUwMCIgaGVpZ2h0PSIzMDAiIGZpbGw9IiNmZmZmZmYiLz4KICAKICA8IS0tIFNxdWFyZSBCICgwLCA2MCAtPiAxMjAsIDE4MCkgLS0+CiAgPHBhdGggZD0iTTEwMCw3MCBMMTgwLDcwIEwxODAsMTAwIEwxMzAsMTAwIEwxMzAsMTMwIEwxODAsMTMwIEwxODAsMTcwIEwxMDAsMTcwIFoiIAogICAgICAgIGZpbGw9IiMwMDRkODQiLz4KICAKICA8IS0tIFNoaWVsZCAoMTUwLCAxMDUgLT4gMjEwLCAxODApIC0tPgogIDxwYXRoIGQ9Ik0xNjAsMTEwIEwyMDAsMTEwIEwyMTAsMTIwIEwyMTAsMTYwIEwxODUsMTgwIEwxNjAsMTYwIFoiIAogICAgICAgIGZpbGw9IiMwMDRkODQiLz4KICAKICA8IS0tIEFycm93IChkaWFnb25hbCwgZ3JhZGllbnQpIC0tPgogIDxkZWZzPgogICAgPGxpbmVhckdyYWRpZW50IGlkPSJhcnJvd0dyYWRpZW50IiB4MT0iMCUiIHkxPSIwJSIgeDI9IjEwMCUiIHkyPSIwJSI+CiAgICAgIDxzdG9wIG9mZnNldD0iMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiM1YTY4N2E7c3RvcC1vcGFjaXR5OjEiIC8+CiAgICAgIDxzdG9wIG9mZnNldD0iNTAlIiBzdHlsZT0ic3RvcC1jb2xvcjojOGI3MzYzO3N0b3Atb3BhY2l0eToxIiAvPgogICAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiNmZmE1MDA7c3RvcC1vcGFjaXR5OjEiIC8+CiAgICA8L2xpbmVhckdyYWRpZW50PgogIDwvZGVmcz4KICA8cGF0aCBkPSJNMTQwLDEzNSBMMjgwLDYwIEwyOTAsNzAgTDI5MCw5NSBMMzEwLDc1IEwzMTAsNDAgTDE1MCwxMTUgWiIgCiAgICAgICAgZmlsbD0idXJsKCNhcnJvd0dyYWRpZW50KSIvPgogIAogIDwhLS0gSiAoMjEwLCA2MCAtPiAyODAsIDE4MCkgLS0+CiAgPHBhdGggZD0iTTIyMCw3MCBMMjcwLDcwIEwyNzAsMTYwIEwyNTUsMTgwIEwyMjAsMTgwIEwyMDUsMTY1IEwyMDUsMTMwIEwyMzUsMTMwIEwyMzUsMTUwIEwyNDUsMTUwIEwyNDUsMTAwIEwyMjAsMTAwIFoiIAogICAgICAgIGZpbGw9IiMwMDRkODQiLz4KICAKICA8IS0tIFRleHQgLS0+CiAgPHRleHQgeD0iMjUwIiB5PSIyNDAiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSI0OCIgZm9udC13ZWlnaHQ9ImJvbGQiIGZpbGw9IiMxYTM1NWUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPkJlemllY3puZSBKdXRybzwvdGV4dD4KPC9zdmc+" alt="Bezpieczne Jutro" style="max-width: 300px; height: auto;">
    </div>

    <div class="header-info">
      <div><strong>Dokument:</strong> Formularz Analizy Potrzeb Klienta (APK)</div>
      <div><strong>Data wype≈Çnienia:</strong> 31.12.2025</div>
    </div>

    <h1>
      Karta Analizy Potrzeb Klienta<br><span style="font-size: 16px; font-weight: normal; text-transform: none">Ubezpieczenia na ≈ªycie i Zdrowie</span>
    </h1>

    <!-- Przyciski akcji -->
    <div class="action-buttons no-print">
      <button class="btn btn-primary" onclick="printForm()">üñ®Ô∏è Drukuj / Zapisz jako PDF</button>
      <button class="btn btn-secondary" onclick="saveFormData()">üíæ Zapisz dane lokalnie</button>
      <button class="btn btn-tertiary" onclick="openEmailModal()">üìß Wy≈õlij przez email</button>
      <button class="btn btn-primary" onclick="loadFormData()">üìÇ Wczytaj zapisane dane</button>
    </div>

    <form id="analysisForm">

    <div class="section">
      <h2>1. Dane Osobowe Klienta</h2>
      <div class="row">
        <div class="col">
          <label for="imie">Imiƒô: <span class="required">*</span></label>
          <input type="text" id="imie" name="imie" required="">
        </div>
        <div class="col">
          <label for="nazwisko">Nazwisko: <span class="required">*</span></label>
          <input type="text" id="nazwisko" name="nazwisko" required="">
        </div>
      </div>
      <div class="row">
        <div class="col">
          <label for="data_urodzenia">Data urodzenia:</label>
          <input type="date" id="data_urodzenia" name="data_urodzenia">
        </div>
      </div>
      <div class="row">
        <div class="col">
          <label for="telefon">Telefon kontaktowy: <span class="required">*</span></label>
          <input type="tel" id="telefon" name="telefon" required="">
        </div>
        <div class="col">
          <label for="email">Adres e-mail: <span class="required">*</span></label>
          <input type="email" id="email" name="email" required="">
        </div>
      </div>
      <div class="row">
        <div class="col">
          <label for="miejscowosc">Miejscowo≈õƒá:</label>
          <input type="text" id="miejscowosc" name="miejscowosc">
        </div>
      </div>
    </div>

    <div class="section">
      <h2>2. Dane Wsp√≥≈Çma≈Ç≈ºonka / Partnera (opcjonalnie)</h2>
      <p style="font-size: 13px; color: #666; margin-bottom: 15px; font-style: italic">
        Wype≈Çnij tylko je≈õli wsp√≥≈Çma≈Ç≈ºonek/partner ma byƒá objƒôty ubezpieczeniem
      </p>
      <div class="checkbox-item" style="margin-bottom: 20px; background-color: #f0f8ff; padding: 10px; border-radius: 5px;">
        <input type="checkbox" id="ubezpieczenie_partnera" name="ubezpieczenie_partnera" value="tak" onchange="togglePartnerSection()">
        <label for="ubezpieczenie_partnera" style="font-weight: 600; color: #2980b9;">
          Tak, chcƒô objƒÖƒá ubezpieczeniem wsp√≥≈Çma≈Ç≈ºonka/partnera
        </label>
      </div>
      
      <div id="partnerSectionContent" class="partner-section-content">
      <div class="row">
        <div class="col">
          <label for="partner_imie">Imiƒô:</label>
          <input type="text" id="partner_imie" name="partner_imie">
        </div>
        <div class="col">
          <label for="partner_nazwisko">Nazwisko:</label>
          <input type="text" id="partner_nazwisko" name="partner_nazwisko">
        </div>
      </div>
      <div class="row">
        <div class="col">
          <label for="partner_data_urodzenia">Data urodzenia:</label>
          <input type="date" id="partner_data_urodzenia" name="partner_data_urodzenia">
        </div>
        <div class="col">
          <label for="partner_telefon">Telefon kontaktowy:</label>
          <input type="tel" id="partner_telefon" name="partner_telefon">
        </div>
      </div>
      <div class="row">
        <div class="col">
          <label for="partner_zawod">Wykonywany zaw√≥d / stanowisko:</label>
          <input type="text" id="partner_zawod" name="partner_zawod">
        </div>
        <div class="col">
          <label>Forma zatrudnienia:</label>
          <select name="partner_forma_zatrudnienia">
            <option value="">Wybierz...</option>
            <option value="umowa_praca">Umowa o pracƒô</option>
            <option value="umowa_zlecenie">Umowa zlecenie / o dzie≈Ço</option>
            <option value="dzialalnosc">W≈Çasna dzia≈Çalno≈õƒá gospodarcza</option>
            <option value="emerytura">Emerytura / Renta</option>
            <option value="bezrobotny">Bezrobotny / UczƒÖcy siƒô</option>
          </select>
        </div>
      </div>
      <label for="partner_uwagi">Uwagi dotyczƒÖce ubezpieczenia partnera (np. posiadane polisy, preferencje):</label>
      <textarea id="partner_uwagi" name="partner_uwagi" rows="3"></textarea>
      </div>
    </div>

    <div class="section">
      <h2>3. Sytuacja Rodzinna</h2>
      <div class="row">
        <div class="col">
          <label>Stan cywilny:</label>
          <select name="stan_cywilny">
            <option value="">Wybierz...</option>
            <option value="kawaler_panna">Kawaler / Panna</option>
            <option value="zona_maz">Mƒô≈ºatka / ≈ªonaty</option>
            <option value="rozwodnik">Rozwiedziona / Rozwiedziony</option>
            <option value="wdowa">Wdowa / Wdowiec</option>
            <option value="partner">ZwiƒÖzek nieformalny</option>
          </select>
        </div>
        <div class="col">
          <label for="liczba_dzieci">Liczba dzieci na utrzymaniu:</label>
          <input type="number" id="liczba_dzieci" name="liczba_dzieci" min="0" max="10" value="0" onchange="generateChildrenFields()">
        </div>
      </div>
      
      <!-- Dynamiczne pola dla dzieci -->
      <div id="childrenFieldsContainer" style="margin-top: 20px;"></div>
      
      <div class="row">
        <div class="col">
          <label for="inne_osoby">Inne osoby na utrzymaniu (np. rodzice):</label>
          <input type="text" id="inne_osoby" name="inne_osoby">
        </div>
      </div>
    </div>

    <div class="section">
      <h2>4. Sytuacja Zawodowa i Finansowa</h2>
      <div class="row">
        <div class="col">
          <label for="zawod">Wykonywany zaw√≥d / stanowisko:</label>
          <input type="text" id="zawod" name="zawod">
        </div>
        <div class="col">
          <label>Forma zatrudnienia:</label>
          <select name="forma_zatrudnienia">
            <option value="">Wybierz...</option>
            <option value="umowa_praca">Umowa o pracƒô</option>
            <option value="umowa_zlecenie">Umowa zlecenie / o dzie≈Ço</option>
            <option value="dzialalnosc">W≈Çasna dzia≈Çalno≈õƒá gospodarcza</option>
            <option value="emerytura">Emerytura / Renta</option>
            <option value="bezrobotny">Bezrobotny / UczƒÖcy siƒô</option>
          </select>
        </div>
      </div>
      <div class="row">
        <div class="col">
          <label for="koszty_zycia">Miesiƒôczne koszty sta≈Çe gospodarstwa (PLN):</label>
          <input type="number" id="koszty_zycia" name="koszty_zycia" placeholder="Rachunki, ≈ºywno≈õƒá, edukacja itp.">
        </div>
      </div>
      <div class="row">
        <div class="col">
          <label for="zobowiazania">Kredyty i po≈ºyczki (ca≈Çkowita kwota do sp≈Çaty):</label>
          <input type="number" id="zobowiazania" name="zobowiazania">
        </div>
        <div class="col">
          <label for="rata_kredytu">Miesiƒôczna rata wszystkich zobowiƒÖza≈Ñ:</label>
          <input type="number" id="rata_kredytu" name="rata_kredytu">
        </div>
      </div>
    </div>

    <div class="section">
      <h2>4a. Priorytety ≈ªyciowe</h2>
      <p style="font-size: 13px; color: #666; margin-bottom: 15px">
        Proszƒô ustawiƒá hierarchiƒô priorytet√≥w (przeciƒÖgnij i upu≈õƒá, aby zmieniƒá kolejno≈õƒá). Pierwszy na li≈õcie = najwa≈ºniejszy.
      </p>
      
      <div id="prioritiesContainer" style="background-color: #f9f9f9; padding: 20px; border-radius: 8px; border: 2px dashed #ccc;">
        <div class="priority-item" draggable="true" data-priority="rodzina">
          <span class="drag-handle">‚ãÆ‚ãÆ</span>
          <span class="priority-number">1.</span>
          <span class="priority-label">Rodzina</span>
        </div>
        <div class="priority-item" draggable="true" data-priority="kariera">
          <span class="drag-handle">‚ãÆ‚ãÆ</span>
          <span class="priority-number">2.</span>
          <span class="priority-label">Kariera</span>
        </div>
        <div class="priority-item" draggable="true" data-priority="dom">
          <span class="drag-handle">‚ãÆ‚ãÆ</span>
          <span class="priority-number">3.</span>
          <span class="priority-label">Posiadanie domu</span>
        </div>
        <div class="priority-item" draggable="true" data-priority="samochod">
          <span class="drag-handle">‚ãÆ‚ãÆ</span>
          <span class="priority-number">4.</span>
          <span class="priority-label">Samoch√≥d</span>
        </div>
        <div class="priority-item" draggable="true" data-priority="podroze">
          <span class="drag-handle">‚ãÆ‚ãÆ</span>
          <span class="priority-number">5.</span>
          <span class="priority-label">Podr√≥≈ºe</span>
        </div>
        <div class="priority-item" draggable="true" data-priority="inne">
          <span class="drag-handle">‚ãÆ‚ãÆ</span>
          <span class="priority-number">6.</span>
          <span class="priority-label">Inne:</span>
          <input type="text" id="inne_priorytet" name="inne_priorytet" placeholder="wpisz w≈Çasny priorytet" style="width: 250px; padding: 5px; margin-left: 10px; display: inline-block; margin-bottom: 0;">
        </div>
      </div>
      
      <input type="hidden" id="priorities_order" name="priorities_order" value="">
      
      <p style="font-size: 12px; color: #999; margin-top: 10px; font-style: italic;">
        üí° Wskaz√≥wka: Chwyƒá za ikonƒô ‚ãÆ‚ãÆ i przeciƒÖgnij element, aby zmieniƒá kolejno≈õƒá priorytet√≥w
      </p>
    </div>

    <div class="section">
      <h2>5. Aktualne Zabezpieczenia</h2>
      <div class="checkbox-group">
        <label style="margin-bottom: 10px">Jakie ubezpieczenia posiada Pan/Pani obecnie?</label>
        <div class="checkbox-item">
          <input type="checkbox" id="zus" name="ubezpieczenia_obecne" value="zus">
          <label for="zus">ZUS / KRUS (podstawowe)</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="grupowe" name="ubezpieczenia_obecne" value="grupowe">
          <label for="grupowe">Ubezpieczenie grupowe w pracy</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="indywidualne" name="ubezpieczenia_obecne" value="indywidualne">
          <label for="indywidualne">Indywidualna polisa na ≈ºycie</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="nnw" name="ubezpieczenia_obecne" value="nnw">
          <label for="nnw">NNW (szkolne/komunikacyjne)</label>
        </div>
      </div>
      <label for="uwagi_zabezpieczenia">Uwagi do posiadanych polis (np. sumy ubezpieczenia, data wyga≈õniƒôcia):</label>
      <textarea id="uwagi_zabezpieczenia" name="uwagi_zabezpieczenia"></textarea>
    </div>

    <div class="section">
      <h2>6. Cele i Potrzeby Ubezpieczeniowe</h2>
      <p style="font-size: 13px; color: #666; margin-bottom: 15px">
        Proszƒô zaznaczyƒá priorytety (1 - ma≈Ço wa≈ºne, 5 - bardzo wa≈ºne) oraz wpisaƒá po≈ºƒÖdanƒÖ kwotƒô zabezpieczenia.
      </p>

      <div style="margin-bottom: 20px; padding: 15px; background-color: #f9f9f9; border-radius: 5px;">
        <div class="row" style="align-items: center; margin-bottom: 10px;">
          <div class="col" style="flex: 2"><strong>Zabezpieczenie finansowe rodziny na wypadek ≈õmierci</strong></div>
          <div class="col" style="flex: 1">
            <label style="font-size: 12px; margin-bottom: 3px;">Priorytet:</label>
            <select name="cel_smierc">
              <option>1</option>
              <option>2</option>
              <option>3</option>
              <option>4</option>
              <option>5</option>
            </select>
          </div>
        </div>
        <div class="row" style="margin-top: 10px;">
          <div class="col">
            <label style="font-size: 12px; margin-bottom: 3px;">Kwota zabezpieczenia (PLN):</label>
            <input type="number" name="kwota_smierc" placeholder="np. 500000" style="margin-bottom: 0;">
          </div>
        </div>
      </div>
      <div style="margin-bottom: 20px; padding: 15px; background-color: #f9f9f9; border-radius: 5px;">
        <div class="row" style="align-items: center; margin-bottom: 10px;">
          <div class="col" style="flex: 2"><strong>Sp≈Çata kredyt√≥w i d≈Çug√≥w w razie nieszczƒô≈õcia</strong></div>
          <div class="col" style="flex: 1">
            <label style="font-size: 12px; margin-bottom: 3px;">Priorytet:</label>
            <select name="cel_kredyt">
              <option>1</option>
              <option>2</option>
              <option>3</option>
              <option>4</option>
              <option>5</option>
            </select>
          </div>
        </div>
        <div class="row" style="margin-top: 10px;">
          <div class="col">
            <label style="font-size: 12px; margin-bottom: 3px;">Kwota zabezpieczenia (PLN):</label>
            <input type="number" name="kwota_kredyt" placeholder="np. 300000" style="margin-bottom: 0;">
          </div>
        </div>
      </div>
      <div style="margin-bottom: 20px; padding: 15px; background-color: #f9f9f9; border-radius: 5px;">
        <div class="row" style="align-items: center; margin-bottom: 10px;">
          <div class="col" style="flex: 2"><strong>≈örodki na leczenie powa≈ºnych zachorowa≈Ñ (np. nowotw√≥r)</strong></div>
          <div class="col" style="flex: 1">
            <label style="font-size: 12px; margin-bottom: 3px;">Priorytet:</label>
            <select name="cel_choroba">
              <option>1</option>
              <option>2</option>
              <option>3</option>
              <option>4</option>
              <option>5</option>
            </select>
          </div>
        </div>
        <div class="row" style="margin-top: 10px;">
          <div class="col">
            <label style="font-size: 12px; margin-bottom: 3px;">Kwota zabezpieczenia (PLN):</label>
            <input type="number" name="kwota_choroba" placeholder="np. 200000" style="margin-bottom: 0;">
          </div>
        </div>
      </div>
      <div style="margin-bottom: 20px; padding: 15px; background-color: #f9f9f9; border-radius: 5px;">
        <div class="row" style="align-items: center; margin-bottom: 10px;">
          <div class="col" style="flex: 2"><strong>Ochrona w przypadku uszczerbku na zdrowiu</strong></div>
          <div class="col" style="flex: 1">
            <label style="font-size: 12px; margin-bottom: 3px;">Priorytet:</label>
            <select name="cel_uszczerbek">
              <option>1</option>
              <option>2</option>
              <option>3</option>
              <option>4</option>
              <option>5</option>
            </select>
          </div>
        </div>
        <div class="row" style="margin-top: 10px;">
          <div class="col">
            <label style="font-size: 12px; margin-bottom: 3px;">Kwota zabezpieczenia (PLN):</label>
            <input type="number" name="kwota_uszczerbek" placeholder="np. 150000" style="margin-bottom: 0;">
          </div>
        </div>
      </div>
      <div style="margin-bottom: 20px; padding: 15px; background-color: #f9f9f9; border-radius: 5px;">
        <div class="row" style="align-items: center; margin-bottom: 10px;">
          <div class="col" style="flex: 2"><strong>Ochrona w przypadku urazu / wypadku</strong></div>
          <div class="col" style="flex: 1">
            <label style="font-size: 12px; margin-bottom: 3px;">Priorytet:</label>
            <select name="cel_uraz">
              <option>1</option>
              <option>2</option>
              <option>3</option>
              <option>4</option>
              <option>5</option>
            </select>
          </div>
        </div>
        <div class="row" style="margin-top: 10px;">
          <div class="col">
            <label style="font-size: 12px; margin-bottom: 3px;">Kwota zabezpieczenia (PLN):</label>
            <input type="number" name="kwota_uraz" placeholder="np. 100000" style="margin-bottom: 0;">
          </div>
        </div>
      </div>
      <div style="margin-bottom: 20px; padding: 15px; background-color: #f9f9f9; border-radius: 5px;">
        <div class="row" style="align-items: center; margin-bottom: 10px;">
          <div class="col" style="flex: 2">
            <strong>Gromadzenie kapita≈Çu (np. emerytura, start dziecka w doros≈Ço≈õƒá)</strong>
          </div>
          <div class="col" style="flex: 1">
            <label style="font-size: 12px; margin-bottom: 3px;">Priorytet:</label>
            <select name="cel_emerytura">
              <option>1</option>
              <option>2</option>
              <option>3</option>
              <option>4</option>
              <option>5</option>
            </select>
          </div>
        </div>
        <div class="row" style="margin-top: 10px;">
          <div class="col">
            <label style="font-size: 12px; margin-bottom: 3px;">Kwota zabezpieczenia (PLN):</label>
            <input type="number" name="kwota_emerytura" placeholder="np. 250000" style="margin-bottom: 0;">
          </div>
        </div>
      </div>
      <div style="margin-bottom: 20px; padding: 15px; background-color: #f9f9f9; border-radius: 5px;">
        <div class="row" style="align-items: center;">
          <div class="col" style="flex: 2">
            <strong>Prywatna opieka medyczna / Dostƒôp do lekarzy specjalist√≥w</strong>
          </div>
          <div class="col" style="flex: 1">
            <label style="font-size: 12px; margin-bottom: 3px;">Priorytet:</label>
            <select name="cel_lekarze">
              <option>1</option>
              <option>2</option>
              <option>3</option>
              <option>4</option>
              <option>5</option>
            </select>
          </div>
        </div>
      </div>
    </div>

    <div class="section">
      <h2>6a. Cele i Potrzeby Ubezpieczeniowe dla Partnera/Wsp√≥≈Çma≈Ç≈ºonka (opcjonalnie)</h2>
      <p style="font-size: 13px; color: #666; margin-bottom: 15px; font-style: italic">
        Wype≈Çnij tylko je≈õli wsp√≥≈Çma≈Ç≈ºonek/partner ma byƒá objƒôty ubezpieczeniem
      </p>
      
      <div id="partnerGoalsContent" class="partner-section-content">
      <p style="font-size: 13px; color: #666; margin-bottom: 15px">
        Proszƒô zaznaczyƒá priorytety dla partnera (1 - ma≈Ço wa≈ºne, 5 - bardzo wa≈ºne) oraz wpisaƒá po≈ºƒÖdanƒÖ kwotƒô zabezpieczenia.
      </p>

      <div style="margin-bottom: 20px; padding: 15px; background-color: #fff5e6; border-radius: 5px;">
        <div class="row" style="align-items: center; margin-bottom: 10px;">
          <div class="col" style="flex: 2"><strong>Zabezpieczenie finansowe rodziny na wypadek ≈õmierci</strong></div>
          <div class="col" style="flex: 1">
            <label style="font-size: 12px; margin-bottom: 3px;">Priorytet:</label>
            <select name="partner_cel_smierc">
              <option>1</option>
              <option>2</option>
              <option>3</option>
              <option>4</option>
              <option>5</option>
            </select>
          </div>
        </div>
        <div class="row" style="margin-top: 10px;">
          <div class="col">
            <label style="font-size: 12px; margin-bottom: 3px;">Kwota zabezpieczenia (PLN):</label>
            <input type="number" name="partner_kwota_smierc" placeholder="np. 500000" style="margin-bottom: 0;">
          </div>
        </div>
      </div>
      <div style="margin-bottom: 20px; padding: 15px; background-color: #fff5e6; border-radius: 5px;">
        <div class="row" style="align-items: center; margin-bottom: 10px;">
          <div class="col" style="flex: 2"><strong>Sp≈Çata kredyt√≥w i d≈Çug√≥w w razie nieszczƒô≈õcia</strong></div>
          <div class="col" style="flex: 1">
            <label style="font-size: 12px; margin-bottom: 3px;">Priorytet:</label>
            <select name="partner_cel_kredyt">
              <option>1</option>
              <option>2</option>
              <option>3</option>
              <option>4</option>
              <option>5</option>
            </select>
          </div>
        </div>
        <div class="row" style="margin-top: 10px;">
          <div class="col">
            <label style="font-size: 12px; margin-bottom: 3px;">Kwota zabezpieczenia (PLN):</label>
            <input type="number" name="partner_kwota_kredyt" placeholder="np. 300000" style="margin-bottom: 0;">
          </div>
        </div>
      </div>
      <div style="margin-bottom: 20px; padding: 15px; background-color: #fff5e6; border-radius: 5px;">
        <div class="row" style="align-items: center; margin-bottom: 10px;">
          <div class="col" style="flex: 2"><strong>≈örodki na leczenie powa≈ºnych zachorowa≈Ñ (np. nowotw√≥r)</strong></div>
          <div class="col" style="flex: 1">
            <label style="font-size: 12px; margin-bottom: 3px;">Priorytet:</label>
            <select name="partner_cel_choroba">
              <option>1</option>
              <option>2</option>
              <option>3</option>
              <option>4</option>
              <option>5</option>
            </select>
          </div>
        </div>
        <div class="row" style="margin-top: 10px;">
          <div class="col">
            <label style="font-size: 12px; margin-bottom: 3px;">Kwota zabezpieczenia (PLN):</label>
            <input type="number" name="partner_kwota_choroba" placeholder="np. 200000" style="margin-bottom: 0;">
          </div>
        </div>
      </div>
      <div style="margin-bottom: 20px; padding: 15px; background-color: #fff5e6; border-radius: 5px;">
        <div class="row" style="align-items: center; margin-bottom: 10px;">
          <div class="col" style="flex: 2"><strong>Ochrona w przypadku uszczerbku na zdrowiu</strong></div>
          <div class="col" style="flex: 1">
            <label style="font-size: 12px; margin-bottom: 3px;">Priorytet:</label>
            <select name="partner_cel_uszczerbek">
              <option>1</option>
              <option>2</option>
              <option>3</option>
              <option>4</option>
              <option>5</option>
            </select>
          </div>
        </div>
        <div class="row" style="margin-top: 10px;">
          <div class="col">
            <label style="font-size: 12px; margin-bottom: 3px;">Kwota zabezpieczenia (PLN):</label>
            <input type="number" name="partner_kwota_uszczerbek" placeholder="np. 150000" style="margin-bottom: 0;">
          </div>
        </div>
      </div>
      <div style="margin-bottom: 20px; padding: 15px; background-color: #fff5e6; border-radius: 5px;">
        <div class="row" style="align-items: center; margin-bottom: 10px;">
          <div class="col" style="flex: 2"><strong>Ochrona w przypadku urazu / wypadku</strong></div>
          <div class="col" style="flex: 1">
            <label style="font-size: 12px; margin-bottom: 3px;">Priorytet:</label>
            <select name="partner_cel_uraz">
              <option>1</option>
              <option>2</option>
              <option>3</option>
              <option>4</option>
              <option>5</option>
            </select>
          </div>
        </div>
        <div class="row" style="margin-top: 10px;">
          <div class="col">
            <label style="font-size: 12px; margin-bottom: 3px;">Kwota zabezpieczenia (PLN):</label>
            <input type="number" name="partner_kwota_uraz" placeholder="np. 100000" style="margin-bottom: 0;">
          </div>
        </div>
      </div>
      <div style="margin-bottom: 20px; padding: 15px; background-color: #fff5e6; border-radius: 5px;">
        <div class="row" style="align-items: center; margin-bottom: 10px;">
          <div class="col" style="flex: 2">
            <strong>Gromadzenie kapita≈Çu (np. emerytura, start dziecka w doros≈Ço≈õƒá)</strong>
          </div>
          <div class="col" style="flex: 1">
            <label style="font-size: 12px; margin-bottom: 3px;">Priorytet:</label>
            <select name="partner_cel_emerytura">
              <option>1</option>
              <option>2</option>
              <option>3</option>
              <option>4</option>
              <option>5</option>
            </select>
          </div>
        </div>
        <div class="row" style="margin-top: 10px;">
          <div class="col">
            <label style="font-size: 12px; margin-bottom: 3px;">Kwota zabezpieczenia (PLN):</label>
            <input type="number" name="partner_kwota_emerytura" placeholder="np. 250000" style="margin-bottom: 0;">
          </div>
        </div>
      </div>
      <div style="margin-bottom: 20px; padding: 15px; background-color: #fff5e6; border-radius: 5px;">
        <div class="row" style="align-items: center;">
          <div class="col" style="flex: 2">
            <strong>Prywatna opieka medyczna / Dostƒôp do lekarzy specjalist√≥w</strong>
          </div>
          <div class="col" style="flex: 1">
            <label style="font-size: 12px; margin-bottom: 3px;">Priorytet:</label>
            <select name="partner_cel_lekarze">
              <option>1</option>
              <option>2</option>
              <option>3</option>
              <option>4</option>
              <option>5</option>
            </select>
          </div>
        </div>
      </div>
      </div>
    </div>

    <div class="section">
      <h2>7. Bud≈ºet i Preferencje</h2>
      <div class="row">
        <div class="col">
          <label for="budzet">Preferowany miesiƒôczny bud≈ºet na sk≈Çadkƒô (PLN):</label>
          <input type="number" id="budzet" name="budzet">
        </div>
        <div class="col">
          <label for="czestotliwosc">Preferowana czƒôstotliwo≈õƒá op≈Çacania sk≈Çadki:</label>
          <select id="czestotliwosc" name="czestotliwosc">
            <option value="miesieczna">Miesiƒôczna</option>
            <option value="kwartalna">Kwartalna</option>
            <option value="polroczna">P√≥≈Çroczna</option>
            <option value="roczna">Roczna</option>
          </select>
        </div>
      </div>
      <label for="oczekiwania_dodatkowe">Dodatkowe oczekiwania lub uwagi klienta:</label>
      <textarea id="oczekiwania_dodatkowe" name="oczekiwania_dodatkowe"></textarea>
      
      <!-- Przycisk generowania rekomendacji -->
      <div style="margin-top: 20px; text-align: center;">
        <button type="button" class="btn btn-primary" onclick="generateRecommendations()" style="font-size: 16px; padding: 15px 30px;">
          üí° Generuj Rekomendacje
        </button>
      </div>
    </div>

    <!-- Sekcja rekomendacji (ukryta domy≈õlnie) -->
    <div id="recommendationsSection" class="section" style="display: none; background-color: #e8f4f8; border: 3px solid #2980b9; border-radius: 8px; padding: 25px; margin-top: 30px;">
      <h2 style="color: #2980b9; text-align: center; margin-bottom: 20px;">
        üìä Rekomendacje dla Klienta
      </h2>
      <div id="recommendationsContent">
        <!-- Tre≈õƒá rekomendacji zostanie wygenerowana przez JavaScript -->
      </div>
    </div>

    <div class="signature-section">
      <div class="row">
        <div class="col">
          <div class="signature-box">Podpis Klienta</div>
        </div>
        <div class="col">
          <div class="signature-box">Podpis Agenta</div>
        </div>
      </div>
      <div style="margin-top: 20px; text-align: right; font-size: 14px">
        Miejscowo≈õƒá, Data: __________________________
      </div>
    </div>

    <div class="legal-note">
      <p>
        <strong>O≈õwiadczenie:</strong> O≈õwiadczam, ≈ºe powy≈ºsze dane zosta≈Çy podane dobrowolnie i sƒÖ zgodne ze stanem
        faktycznym. Informacje te pos≈Çu≈ºƒÖ wy≈ÇƒÖcznie do przygotowania oferty ubezpieczeniowej dopasowanej do moich
        potrzeb. Wyra≈ºam zgodƒô na przetwarzanie moich danych osobowych w celu przygotowania oferty.
      </p>
    </div>

    </form>

    <!-- Modal do wysy≈Çki email -->
    <div id="emailModal" class="email-modal">
      <div class="email-modal-content">
        <span class="email-modal-close" onclick="closeEmailModal()">√ó</span>
        <h2 style="margin-top: 0;">Wy≈õlij formularz przez email</h2>
        <p style="font-size: 13px; color: #666;">Uwaga: To jest wersja demonstracyjna. W pe≈Çnej wersji formularz zosta≈Çby wys≈Çany na wskazany adres.</p>
        <label for="recipient_email">Adres e-mail odbiorcy:</label>
        <input type="email" id="recipient_email" value="d.grzymala@bezpiecznejutro.online" style="width: 100%; margin-bottom: 15px;">
        <label for="email_subject">Temat wiadomo≈õci:</label>
        <input type="text" id="email_subject" value="Formularz Analizy Potrzeb Klienta" style="width: 100%; margin-bottom: 15px;">
        <div style="display: flex; gap: 10px; margin-top: 20px;">
          <button class="btn btn-secondary" onclick="sendFormByEmail()" style="flex: 1;">Wy≈õlij</button>
          <button class="btn btn-tertiary" onclick="closeEmailModal()" style="flex: 1;">Anuluj</button>
        </div>
      </div>
    </div>

    <script>
      // Funkcja do obliczania wieku konkretnego dziecka
      function calculateChildAge(childIndex) {
        const dateInput = document.getElementById(`dziecko_${childIndex}_data_urodzenia`);
        const ageInput = document.getElementById(`dziecko_${childIndex}_wiek`);
        
        if (dateInput && ageInput && dateInput.value) {
          const birthDate = new Date(dateInput.value);
          const today = new Date();
          let age = today.getFullYear() - birthDate.getFullYear();
          const monthDiff = today.getMonth() - birthDate.getMonth();
          
          if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
            age--;
          }
          
          ageInput.value = age >= 0 ? age : 0;
        }
      }
      
      // Funkcja do generowania p√≥l dla dzieci
      function generateChildrenFields() {
        const liczbadzieci = parseInt(document.getElementById('liczba_dzieci').value) || 0;
        const container = document.getElementById('childrenFieldsContainer');
        
        // Wyczy≈õƒá istniejƒÖce pola
        container.innerHTML = '';
        
        if (liczbadzieci > 0) {
          container.innerHTML = '<h3 style="margin-top: 20px; margin-bottom: 15px; color: #2980b9;">Dane dzieci:</h3>';
          
          for (let i = 1; i <= liczbadzieci; i++) {
            const childDiv = document.createElement('div');
            childDiv.style.marginBottom = '20px';
            childDiv.style.padding = '15px';
            childDiv.style.backgroundColor = '#f9f9f9';
            childDiv.style.borderRadius = '5px';
            childDiv.style.border = '1px solid #e0e0e0';
            
            childDiv.innerHTML = `
              <h4 style="margin-top: 0; margin-bottom: 10px; color: #555;">Dziecko ${i}</h4>
              <div class="row">
                <div class="col">
                  <label for="dziecko_${i}_imie">Imiƒô:</label>
                  <input type="text" id="dziecko_${i}_imie" name="dziecko_${i}_imie">
                </div>
                <div class="col">
                  <label for="dziecko_${i}_nazwisko">Nazwisko:</label>
                  <input type="text" id="dziecko_${i}_nazwisko" name="dziecko_${i}_nazwisko">
                </div>
              </div>
              <div class="row">
                <div class="col">
                  <label for="dziecko_${i}_data_urodzenia">Data urodzenia:</label>
                  <input type="date" id="dziecko_${i}_data_urodzenia" name="dziecko_${i}_data_urodzenia" onchange="calculateChildAge(${i})" oninput="calculateChildAge(${i})">
                </div>
                <div class="col">
                  <label for="dziecko_${i}_wiek">Wiek (lat):</label>
                  <input type="number" id="dziecko_${i}_wiek" name="dziecko_${i}_wiek" min="0" max="100" placeholder="Obliczany automatycznie" readonly style="background-color: #e9ecef;">
                </div>
              </div>
            `;
            
            container.appendChild(childDiv);
          }
        }
      }
      
      // Funkcja calculateChildAge zosta≈Ça przesuniƒôta na poczƒÖtek skryptu

      // Funkcja do pokazywania/ukrywania sekcji partnera
      function togglePartnerSection() {
        const checkbox = document.getElementById('ubezpieczenie_partnera');
        const partnerContent = document.getElementById('partnerSectionContent');
        const partnerGoalsContent = document.getElementById('partnerGoalsContent');
        
        if (checkbox.checked) {
          partnerContent.classList.add('active');
          partnerGoalsContent.classList.add('active');
        } else {
          partnerContent.classList.remove('active');
          partnerGoalsContent.classList.remove('active');
        }
      }

      // Funkcja do drukowania formularza
      function printForm() {
        window.print();
      }

      // Funkcja do zapisywania danych formularza lokalnie
      function saveFormData() {
        const form = document.getElementById('analysisForm');
        const formData = new FormData(form);
        const data = {};
        
        for (let [key, value] of formData.entries()) {
          data[key] = value;
        }
        
        // Zapisz do localStorage
        localStorage.setItem('formularAnaliza', JSON.stringify(data));
        
        // Zapisz datƒô
        const saveDate = new Date().toLocaleString('pl-PL');
        localStorage.setItem('formularAnalizaData', saveDate);
        
        alert('‚úÖ Dane formularza zosta≈Çy zapisane lokalnie!\n\nData zapisu: ' + saveDate + '\n\nMo≈ºesz je wczytaƒá w ka≈ºdej chwili klikajƒÖc "Wczytaj zapisane dane".');
      }

      // Funkcja do wczytywania zapisanych danych
      function loadFormData() {
        const savedData = localStorage.getItem('formularAnaliza');
        const saveDate = localStorage.getItem('formularAnalizaData');
        
        if (!savedData) {
          alert('‚ùå Nie znaleziono zapisanych danych.');
          return;
        }
        
        if (confirm('Czy na pewno chcesz wczytaƒá dane zapisane dnia: ' + saveDate + '?\n\nAktualne dane w formularzu zostanƒÖ nadpisane.')) {
          const data = JSON.parse(savedData);
          const form = document.getElementById('analysisForm');
          
          // Najpierw wype≈Çnij liczbƒô dzieci, aby wygenerowaƒá pola
          if (data.liczba_dzieci) {
            document.getElementById('liczba_dzieci').value = data.liczba_dzieci;
            generateChildrenFields();
          }
          
          // Wype≈Çnij formularz
          for (let key in data) {
            const element = form.elements[key];
            if (element) {
              if (element.type === 'checkbox') {
                element.checked = data[key] === 'tak';
              } else if (element.type === 'radio') {
                const radio = form.querySelector(`input[name="${key}"][value="${data[key]}"]`);
                if (radio) radio.checked = true;
              } else {
                element.value = data[key];
              }
            }
          }
          
          // Sprawd≈∫ czy pokazaƒá sekcjƒô partnera
          togglePartnerSection();
          
          // Przelicz wiek dzieci
          const liczbadzieci = parseInt(document.getElementById('liczba_dzieci').value) || 0;
          for (let i = 1; i <= liczbadzieci; i++) {
            calculateChildAge(i);
          }
          
          alert('‚úÖ Dane zosta≈Çy wczytane pomy≈õlnie!');
        }
      }

      // Funkcja do otwierania modala email
      function openEmailModal() {
        const modal = document.getElementById('emailModal');
        modal.style.display = 'block';
      }

      // Funkcja do zamykania modala email
      function closeEmailModal() {
        const modal = document.getElementById('emailModal');
        modal.style.display = 'none';
      }

      // Funkcja do wysy≈Çania formularza przez email (symulacja)
      function sendFormByEmail() {
        const recipientEmail = document.getElementById('recipient_email').value;
        const subject = document.getElementById('email_subject').value;
        
        if (!recipientEmail) {
          alert('‚ùå Proszƒô podaƒá adres e-mail odbiorcy.');
          return;
        }
        
        // W prawdziwej implementacji tutaj by≈Çoby wys≈Çanie formularza przez backend
        alert('‚úÖ Funkcja wysy≈Çki email!\n\nW pe≈Çnej wersji formularz zosta≈Çby wys≈Çany na adres:\n' + recipientEmail + '\n\nTemat: ' + subject + '\n\nAby zaimplementowaƒá tƒô funkcjƒô, potrzebujesz backendu (np. PHP, Node.js) z konfiguracjƒÖ serwera SMTP.');
        
        closeEmailModal();
      }

      // Zamknij modal klikajƒÖc poza nim
      window.onclick = function(event) {
        const modal = document.getElementById('emailModal');
        if (event.target == modal) {
          closeEmailModal();
        }
      }

      // Walidacja formularza przed drukowaniem
      window.addEventListener('beforeprint', function() {
        console.log('Przygotowanie do drukowania...');
      });

      // Ustaw domy≈õlnƒÖ datƒô wype≈Çnienia przy ≈Çadowaniu strony
      window.addEventListener('load', function() {
        const today = new Date().toLocaleDateString('pl-PL');
        const headerInfo = document.querySelector('.header-info div:last-child');
        if (headerInfo) {
          headerInfo.innerHTML = '<strong>Data wype≈Çnienia:</strong> ' + today;
        }
        
        // Inicjalizuj drag & drop dla priorytet√≥w
        initPrioritiesDragDrop();
        updatePrioritiesOrder();
      });

      // Funkcja inicjalizujƒÖca drag & drop dla priorytet√≥w
      function initPrioritiesDragDrop() {
        const container = document.getElementById('prioritiesContainer');
        const items = container.querySelectorAll('.priority-item');
        let draggedItem = null;

        items.forEach(item => {
          item.addEventListener('dragstart', function(e) {
            draggedItem = this;
            this.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
          });

          item.addEventListener('dragend', function(e) {
            this.classList.remove('dragging');
            items.forEach(i => i.classList.remove('drag-over'));
            updatePrioritiesNumbers();
            updatePrioritiesOrder();
          });

          item.addEventListener('dragover', function(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
            
            if (draggedItem !== this) {
              this.classList.add('drag-over');
            }
          });

          item.addEventListener('dragleave', function(e) {
            this.classList.remove('drag-over');
          });

          item.addEventListener('drop', function(e) {
            e.preventDefault();
            this.classList.remove('drag-over');
            
            if (draggedItem !== this) {
              const allItems = [...container.querySelectorAll('.priority-item')];
              const draggedIndex = allItems.indexOf(draggedItem);
              const targetIndex = allItems.indexOf(this);
              
              if (draggedIndex < targetIndex) {
                this.parentNode.insertBefore(draggedItem, this.nextSibling);
              } else {
                this.parentNode.insertBefore(draggedItem, this);
              }
            }
          });
        });
      }

      // Funkcja aktualizujƒÖca numery priorytet√≥w
      function updatePrioritiesNumbers() {
        const items = document.querySelectorAll('#prioritiesContainer .priority-item');
        items.forEach((item, index) => {
          const numberSpan = item.querySelector('.priority-number');
          if (numberSpan) {
            numberSpan.textContent = (index + 1) + '.';
          }
        });
      }

      // Funkcja zapisujƒÖca kolejno≈õƒá priorytet√≥w do ukrytego pola
      function updatePrioritiesOrder() {
        const items = document.querySelectorAll('#prioritiesContainer .priority-item');
        const order = [];
        
        items.forEach((item, index) => {
          const priority = item.getAttribute('data-priority');
          let label = item.querySelector('.priority-label').textContent.trim().replace(':', '');
          
          // Je≈õli to "Inne", dodaj warto≈õƒá z inputa
          if (priority === 'inne') {
            const inneInput = document.getElementById('inne_priorytet');
            if (inneInput && inneInput.value) {
              label = 'Inne: ' + inneInput.value;
            }
          }
          
          order.push((index + 1) + '. ' + label);
        });
        
        document.getElementById('priorities_order').value = order.join(' | ');
      }

      // Aktualizuj kolejno≈õƒá gdy u≈ºytkownik wpisze co≈õ w pole "Inne"
      document.addEventListener('DOMContentLoaded', function() {
        const inneInput = document.getElementById('inne_priorytet');
        if (inneInput) {
          inneInput.addEventListener('input', updatePrioritiesOrder);
        }
      });

      // Funkcja generowania rekomendacji
      function generateRecommendations() {
        const form = document.getElementById('analysisForm');
        const formData = new FormData(form);
        
        // Sprawd≈∫ czy podstawowe dane sƒÖ wype≈Çnione
        const imie = formData.get('imie');
        const nazwisko = formData.get('nazwisko');
        
        if (!imie || !nazwisko) {
          alert('‚ö†Ô∏è Proszƒô wype≈Çniƒá przynajmniej imiƒô i nazwisko przed wygenerowaniem rekomendacji.');
          return;
        }
        
        // Zbierz dane z formularza
        const data = {
          imie: imie,
          nazwisko: nazwisko,
          liczba_dzieci: parseInt(formData.get('liczba_dzieci')) || 0,
          koszty_zycia: parseInt(formData.get('koszty_zycia')) || 0,
          zobowiazania: parseInt(formData.get('zobowiazania')) || 0,
          budzet: parseInt(formData.get('budzet')) || 0,
          // Priorytety
          cel_smierc: parseInt(formData.get('cel_smierc')) || 1,
          cel_kredyt: parseInt(formData.get('cel_kredyt')) || 1,
          cel_choroba: parseInt(formData.get('cel_choroba')) || 1,
          cel_uszczerbek: parseInt(formData.get('cel_uszczerbek')) || 1,
          cel_uraz: parseInt(formData.get('cel_uraz')) || 1,
          cel_emerytura: parseInt(formData.get('cel_emerytura')) || 1,
          cel_lekarze: parseInt(formData.get('cel_lekarze')) || 1,
          // Kwoty zabezpieczenia
          kwota_smierc: parseInt(formData.get('kwota_smierc')) || 0,
          kwota_kredyt: parseInt(formData.get('kwota_kredyt')) || 0,
          kwota_choroba: parseInt(formData.get('kwota_choroba')) || 0,
          kwota_uszczerbek: parseInt(formData.get('kwota_uszczerbek')) || 0,
          kwota_uraz: parseInt(formData.get('kwota_uraz')) || 0,
          kwota_emerytura: parseInt(formData.get('kwota_emerytura')) || 0,
          // Priorytety ≈ºyciowe
          priorities_order: formData.get('priorities_order') || ''
        };
        
        // Generuj rekomendacje
        let recommendations = [];
        
        // 1. Analiza sytuacji rodzinnej
        if (data.liczba_dzieci > 0) {
          recommendations.push({
            type: 'warning',
            title: 'üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Ochrona rodziny',
            text: `PosiadajƒÖc ${data.liczba_dzieci} ${data.liczba_dzieci === 1 ? 'dziecko' : 'dzieci'} na utrzymaniu, szczeg√≥lnie wa≈ºne jest zabezpieczenie finansowe rodziny. Rekomendujemy priorytetowe potraktowanie ubezpieczenia na ≈ºycie oraz ubezpieczenia od powa≈ºnych zachorowa≈Ñ.`
          });
        }
        
        // 2. Analiza zobowiƒÖza≈Ñ finansowych
        if (data.zobowiazania > 0) {
          const ratioZobowiazania = data.zobowiazania / (data.koszty_zycia * 12 || 1);
          if (ratioZobowiazania > 3) {
            recommendations.push({
              type: 'warning',
              title: 'üí∞ Wysokie zobowiƒÖzania finansowe',
              text: `≈ÅƒÖczna kwota zobowiƒÖza≈Ñ wynosi ${data.zobowiazania.toLocaleString('pl-PL')} PLN. W przypadku utraty zdolno≈õci zarobkowania, zabezpieczenie tego zobowiƒÖzania powinno byƒá priorytetem. Sugerowana suma ubezpieczenia na sp≈Çatƒô kredyt√≥w: minimum ${data.zobowiazania.toLocaleString('pl-PL')} PLN.`
            });
          }
        }
        
        // 3. Analiza priorytet√≥w i kwot
        let highPriorities = [];
        const goals = [
          {name: 'Zabezpieczenie finansowe rodziny na wypadek ≈õmierci', priority: data.cel_smierc, kwota: data.kwota_smierc},
          {name: 'Sp≈Çata kredyt√≥w i d≈Çug√≥w', priority: data.cel_kredyt, kwota: data.kwota_kredyt},
          {name: 'Leczenie powa≈ºnych zachorowa≈Ñ', priority: data.cel_choroba, kwota: data.kwota_choroba},
          {name: 'Uszczerbek na zdrowiu', priority: data.cel_uszczerbek, kwota: data.kwota_uszczerbek},
          {name: 'Urazy i wypadki', priority: data.cel_uraz, kwota: data.kwota_uraz},
          {name: 'Gromadzenie kapita≈Çu', priority: data.cel_emerytura, kwota: data.kwota_emerytura}
        ];
        
        goals.forEach(goal => {
          if (goal.priority >= 4) {
            highPriorities.push(goal);
          }
        });
        
        if (highPriorities.length > 0) {
          let prioritiesText = '<ul style="margin: 10px 0; padding-left: 20px;">';
          highPriorities.forEach(p => {
            prioritiesText += `<li><strong>${p.name}</strong> (priorytet: ${p.priority}/5)`;
            if (p.kwota > 0) {
              prioritiesText += ` - wskazana suma: <strong>${p.kwota.toLocaleString('pl-PL')} PLN</strong>`;
            }
            prioritiesText += '</li>';
          });
          prioritiesText += '</ul>';
          
          recommendations.push({
            type: 'info',
            title: 'üéØ G≈Ç√≥wne priorytety klienta',
            text: `Zidentyfikowano nastƒôpujƒÖce wysokie priorytety ubezpieczeniowe:${prioritiesText}`
          });
        }
        
        // 4. Analiza bud≈ºetu
        if (data.budzet > 0) {
          const totalWishedAmount = data.kwota_smierc + data.kwota_kredyt + data.kwota_choroba + 
                                    data.kwota_uszczerbek + data.kwota_uraz + data.kwota_emerytura;
          
          if (totalWishedAmount > 0) {
            recommendations.push({
              type: 'info',
              title: 'üíµ Analiza bud≈ºetu i sum ubezpieczenia',
              text: `Deklarowany miesiƒôczny bud≈ºet: <strong>${data.budzet.toLocaleString('pl-PL')} PLN</strong><br>
                     ≈ÅƒÖczna wskazana suma ubezpieczenia: <strong>${totalWishedAmount.toLocaleString('pl-PL')} PLN</strong><br>
                     Zalecamy przygotowanie oferty optymalnie dopasowanej do bud≈ºetu, z mo≈ºliwo≈õciƒÖ roz≈Ço≈ºenia ochrony w czasie.`
            });
          }
        }
        
        // 5. Priorytety ≈ºyciowe
        if (data.priorities_order) {
          recommendations.push({
            type: 'info',
            title: 'üåü Hierarchia priorytet√≥w ≈ºyciowych',
            text: `Priorytety ≈ºyciowe klienta w kolejno≈õci:<br><strong>${data.priorities_order.replace(/\|/g, '<br>')}</strong><br>
                   Oferta ubezpieczeniowa powinna uwzglƒôdniaƒá te priorytety przy planowaniu d≈Çugoterminowej ochrony.`
          });
        }
        
        // 6. Rekomendacja og√≥lna
        recommendations.push({
          type: '',
          title: 'üìã Podsumowanie i kolejne kroki',
          text: `Na podstawie analizy potrzeb Pana/Pani <strong>${data.imie} ${data.nazwisko}</strong>, rekomendujemy:
                 <ul style="margin: 10px 0; padding-left: 20px;">
                   <li>Um√≥wienie spotkania w celu szczeg√≥≈Çowego om√≥wienia dostƒôpnych produkt√≥w ubezpieczeniowych</li>
                   <li>Przygotowanie spersonalizowanej oferty uwzglƒôdniajƒÖcej wskazane priorytety i bud≈ºet</li>
                   <li>Rozwa≈ºenie etapowego budowania pe≈Çnej ochrony ubezpieczeniowej</li>
                   <li>Regularne przeglƒÖdanie i aktualizowanie zakresu ochrony wraz ze zmianƒÖ sytuacji ≈ºyciowej</li>
                 </ul>`
        });
        
        // Generuj tabelƒô podsumowujƒÖcƒÖ
        let summaryTable = `
          <table class="summary-table">
            <thead>
              <tr>
                <th>Obszar ochrony</th>
                <th>Priorytet (1-5)</th>
                <th>Wskazana suma (PLN)</th>
              </tr>
            </thead>
            <tbody>
        `;
        
        goals.forEach(goal => {
          summaryTable += `
            <tr>
              <td>${goal.name}</td>
              <td style="text-align: center; font-weight: bold;">${goal.priority}</td>
              <td style="text-align: right;">${goal.kwota > 0 ? goal.kwota.toLocaleString('pl-PL') : '-'}</td>
            </tr>
          `;
        });
        
        summaryTable += `
            </tbody>
          </table>
        `;
        
        // Wy≈õwietl rekomendacje
        const section = document.getElementById('recommendationsSection');
        const content = document.getElementById('recommendationsContent');
        
        let html = '<h3 style="margin-top: 0; color: #2c3e50;">üìä Tabela priorytet√≥w</h3>';
        html += summaryTable;
        html += '<h3 style="margin-top: 30px; color: #2c3e50;">üí° Szczeg√≥≈Çowe rekomendacje</h3>';
        
        recommendations.forEach(rec => {
          html += `
            <div class="recommendation-box ${rec.type}">
              <div class="recommendation-title">${rec.title}</div>
              <div class="recommendation-text">${rec.text}</div>
            </div>
          `;
        });
        
        content.innerHTML = html;
        section.style.display = 'block';
        
        // Przewi≈Ñ do sekcji rekomendacji
        section.scrollIntoView({ behavior: 'smooth', block: 'start' });
        
        alert('‚úÖ Rekomendacje zosta≈Çy wygenerowane! Przewi≈Ñ w d√≥≈Ç, aby je zobaczyƒá.');
      }
    </script>
  

</body></html>